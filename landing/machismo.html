<!DOCTYPE HTML>

<html>

<head>

<link rel="stylesheet" href="machismo.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="serialize-object.js"></script>

<script>
function updateLevel(val) {
          document.getElementById('LevelLabel').value=val+"%"; 
        }
</script>

<script>
function updateText(val) {
          document.getElementById('Docu').value=val; 
        }
</script>

<script>
var docsfile = "http://psicobotica.com/machismo/docs-machismo.txt";
</script>


</head>

<body onload="updateLevel(50)">


<center>

<h1>¡Ayúdanos a entrenar a EqualBot!</h1>
<h2>La Inteligencia Artificial que detecta el Lenguaje Machista</h2>
<hr>

<form id="form-machismo">

<h3>Por favor, lee este fragmento de texto:</h3>

<script>
var aLines;

$.get(docsfile, function(textData, status) {
    aLines = textData.split("\n")
    
	console.log("Read Lines: " + aLines.length)
	
	var selected = aLines[Math.floor(Math.random()*aLines.length)];
    // $.each(aLines, function(n, sLine) {
    $('div#textFromFile').text(selected);
	console.log("Selectec text: " + selected)
	updateText(selected)	
    });
// }, 'text');



</script>

<div id="thanksMsg">
</div>

<div class="docu" id="textFromFile">
</div>

<input hidden type="text" id="Docu" name="texto"> 
<br><br>

<h3>Selecciona el Nivel de Machismo que percibes y haz clic en Enviar:<h4>

<table>
<tr>
<td>Nada Machista</td>

<td>
<input
id="Level"
type="range" 
name="nivel" 
min="0" max="100" step="5" 
onchange="updateLevel(this.value);"
onmouseover="updateLevel(this.value);"
onclick="updateLevel(this.value);">
</td>

<td>Muy Machista</td>
</tr>
</table>

<output type="text" id="LevelLabel" value="50"></output>

<br><br>
<button type="submit" id="submit-form">Enviar</button>

</form>

<script >
var $form = $('form#form-machismo'),
    url = 'https://script.google.com/macros/s/AKfycbzlOJmLZvsxyetH-0gXf32r7C3yEELv4wWaEbZXTFks2_PCOdZu/exec'

$('#submit-form').on('click', function(e) {
  e.preventDefault();
  var jqxhr = $.ajax({
    url: url,
    method: "GET",
    dataType: "json",
    data: $form.serializeObject(),
	success: function(response){
		document.getElementById("thanksMsg").innerHTML = "Gracias";
    }
  });
})
</script>


<hr>

</center>

</body>

</html>